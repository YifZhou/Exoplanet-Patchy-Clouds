function pDistr=MCFit_fixP(fn1, fn2, nLoop, outputFN)
M1 = csvread(fn1, 1);
t1 = M1(:, 1);
fB1 = M1(:, 2);
err1 = M1(:, 3);

M2 = csvread(fn2, 1);
t2 = M2(:, 1);
fB2 = M2(:, 2);
err2 = M2(:, 3);
pDistr = zeros(nLoop, 1);
p0 = [0.01 10.0, 0, 0.01, 0];
for i=1:nLoop
    err1_1 = err1 .* randn(size(fB1));
    fB1_1 = fB1 + err1_1;
    err2_1 = err2 .* randn(size(fB2));
    fB2_1 = fB2 + err2_1;
    F=@(p)[sum((p(1)*sin((2*pi/p(2))*t1+p(3)) + 1 - fB1_1)./err1), ...
       sum((p(4)*sin((2*pi/p(2))*t2+p(5)) + 1 - fB2_1)./err2)];
    [p, ~] = lsqnonlin(F,p0);
    pDistr(i) = p(2);
end
csvwrite(outputFN, pDistr);
